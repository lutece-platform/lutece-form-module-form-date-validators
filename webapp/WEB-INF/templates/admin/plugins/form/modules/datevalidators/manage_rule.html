<#macro action_sort jsp_url attribute>
	<a class="btn btn-small" href="${jsp_url}&sorted_attribute_name=${attribute}&asc_sort=true" title="#i18n{portal.util.sort.asc}">
		<i class="icon-chevron-up"></i>
	</a>
	<a class="btn btn-small" href="${jsp_url}&sorted_attribute_name=${attribute}&asc_sort=false" title="#i18n{portal.util.sort.desc}">
    	<i class="icon-chevron-down"></i> 
    </a>
</#macro>

<#macro action_delete id_rule>
	<#if permission_delete>
        <a class="btn btn-small btn-danger" href="jsp/admin/plugins/form/modules/datevalidators/ConfirmRemoveRule.jsp?id_form=${id_form}&id_rule=${id_rule}" title="#i18n{module.form.datevalidators.manageRule.altDelete}">
        	<i class="icon-chevron-down"></i>
        </a>
    </#if>
</#macro>
<div class="row-fluid">
	<div class="span12">
		<fieldset>
			<legend>#i18n{module.form.datevalidators.manageRule.title}
			<#if permission_create>
				<form method="post" class="form-inline pull-right" action="jsp/admin/plugins/form/modules/datevalidators/SelectType.jsp?id_form=${id_form}">
					<button class="btn btn-small btn-primary" type="submit" >
						<i class="icon-plus icon-white"></i>&nbsp;#i18n{module.form.datevalidators.manageRule.buttonCreate}
					</button>
				</form>
			</#if>
			<#if permission_manage>
				<form method="post" class="form-inline spaced pull-right" action="jsp/admin/plugins/form/modules/datevalidators/ManageDateCalculated.jsp?id_form=${id_form}">
					<button class="btn btn-small btn-primary" type="submit" >
						<i class="icon-calendar icon-white"></i>&nbsp;#i18n{module.form.datevalidators.manageRule.buttonManageDateCalculated}
					</button>
				</form>
			</#if>
			</legend>
			<div class="well well-small">
			<@paginationAdmin paginator=paginator combo=1/>
			<!-- form method="post" action="jsp/admin/plugins/form/ManageValidator.jsp">
				<@pagination paginator = paginator />
				#i18n{module.form.datevalidators.manageRule.labelItemsPerPage} :
				<select name="items_per_page">
					<#list [ "10" , "20" , "50" , "100" ] as nb>
						<#if nb_items_per_page = nb>
							<option value="${nb}" selected="selected">${nb}</option>
						<#else>
							<option value="${nb}">${nb}</option>
						</#if>
					</#list>
				</select>
				<input type="hidden" name="id_form" value="${id_form}" />
				<input type="hidden" name="sorted_attribute_name" value="${sorted_attribute_name!}" />
				<input type="hidden" name="asc_sort" value="${asc_sort!}" />
				<input class="button" type="submit" value="#i18n{module.form.datevalidators.manageRule.buttonItemsPerPage}" />
			</form -->

			<table class="table table-striped table-condensed">
				<tr>
					<th>#i18n{module.form.datevalidators.manageRule.rowEntry}
						<@action_sort jsp_url="jsp/admin/plugins/form/ManageValidator.jsp?id_form=${id_form}" attribute="idEntry1" />
					</th>
					<th>#i18n{module.form.datevalidators.manageRule.rowComparator}</th>
					<th>#i18n{module.form.datevalidators.manageRule.rowValue}</th>
					<th>#i18n{module.form.datevalidators.manageRule.rowType}</th>
					<th>#i18n{module.form.datevalidators.manageRule.rowActions}</th>
				</tr>
				<#list rule_list as rule>
					<tr>
						<td>${rule.idEntry1} - <#list entry_list as entry><#if entry.idEntry == rule.idEntry1>${entry.title}</#if></#list></td>
						<td><#list comparator_list as comparator><#if comparator.code == rule.idComparator?string>${comparator.name}</#if></#list></td>
						<#-- Entry -->
						<#if rule.idEntry2?has_content>
							<td>${rule.idEntry2} - <#list entry_list as entry><#if entry.idEntry == rule.idEntry2>${entry.title}</#if></#list></td>
							<td>#i18n{module.form.datevalidators.manageRule.typeEntry}</td>
							<td>
								<#if permission_modify>
									<a class="btn btn-small btn-primary" title="#i18n{module.form.datevalidators.manageRule.altModify}" href="jsp/admin/plugins/form/modules/datevalidators/ModifyRuleEntry.jsp?id_rule=${rule.idRule}">
										<i class="icon-edit icon-white"></i>
									</a>
								</#if>
								<@action_delete rule.idRule />
							</td>
								
						<#-- Reference date -->
						<#elseif rule.dateReference?has_content>
							<td>${rule.dateReference?date}</td>
							<td>#i18n{module.form.datevalidators.manageRule.typeDateReference}</td>
							<td>
								<#if permission_modify>
									<a class="btn btn-small btn-primary" title="#i18n{module.form.datevalidators.manageRule.altModify}" href="jsp/admin/plugins/form/modules/datevalidators/ModifyRuleDateReference.jsp?id_rule=${rule.idRule}">
										<i class="icon-edit icon-white"></i>
									</a>
								</#if>
								<@action_delete rule.idRule />
							</td>
							
						<#-- Calculated date -->
						<#elseif rule.dateCalculated?has_content>
							<td>
								${rule.dateCalculated.idDateCalculated}
								-
								${rule.dateCalculated.dateReference?date}
								${rule.dateCalculated.operator.name}
								${rule.dateCalculated.number}
								#i18n{${rule.dateCalculated.unit.name}}
							</td>
							<td>#i18n{module.form.datevalidators.manageRule.typeDateCalculated}</td>
							<td>
								<#if permission_modify>
									<a class="btn btn-small btn-primary" title="#i18n{module.form.datevalidators.manageRule.altModify}" href="jsp/admin/plugins/form/modules/datevalidators/ModifyRuleDateCalculated.jsp?id_rule=${rule.idRule}">
										<i class="icon-edit icon-white"></i>
									</a>
								</#if>
								<@action_delete rule.idRule />
							</td>
						</#if>
					</tr>
				</#list>
			</table>
		</div>
	</div>
</div>

